set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS}")
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} ${CMAKE_C_FLAGS}")
set(CMAKE_LINK_FLAGS "${CMAKE_LINK_FLAGS}")

if(WITH_EGL)
	PKG_CHECK_MODULES(WAYLANDCLIENT REQUIRED wayland-client)
	INCLUDE_DIRECTORIES(${WAYLANDCLIENT_INCLUDE_DIRS})
	LINK_DIRECTORIES(${WAYLANDCLIENT_LIBRARY_DIRS})

	PKG_CHECK_MODULES(WAYLANDEGL REQUIRED wayland-egl)
	INCLUDE_DIRECTORIES(${WAYLANDEGL_INCLUDE_DIRS})
	LINK_DIRECTORIES(${WAYLANDEGL_LIBRARY_DIRS})

	wayland_add_protocol_client(PROTOCOLS
		${CMAKE_SOURCE_DIR}/protocol/xdg-shell.xml
		xdg-shell
		)

	include_directories(
		${CMAKE_CURRENT_BINARY_DIR}
		${CMAKE_SOURCE_DIR}/tale
		)

	add_executable(tale-egl
		tale-egl.c
		${PROTOCOLS}
		)

	TARGET_LINK_LIBRARIES(tale-egl
		nemotale
		${NEMOUX_COMMON_LIBRARIES}
		${WAYLANDCLIENT_LIBRARIES}
		${WAYLANDEGL_LIBRARIES}
		)

	add_executable(tale-fbo
		tale-fbo.c
		${PROTOCOLS}
		)

	TARGET_LINK_LIBRARIES(tale-fbo
		nemotale
		${NEMOUX_COMMON_LIBRARIES}
		${WAYLANDCLIENT_LIBRARIES}
		${WAYLANDEGL_LIBRARIES}
		)
endif(WITH_EGL)
